# Задание №9. Вариант 8
Пропускная способность дуг сети указана в таблице.

|          Дуги          | sc | sb | ac | ba | bc | bd | cd | dt | ct |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 9  | 5  | 4  | 1  | 3  | 7  | 8  | 12 |  2 |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг.

```mermaid
graph LR
    s-->|9|c
    s-->|5|b
    a-->|4|c
    b-->|1|a
    b-->|3|c
    b-->|7|d
    c-->|8|d
    d-->|12|t
    c-->|2|t
```

Построим остаточную сеть. Так как изначально поток в сети не задан, все дуги сети являются пустыми (локальный поток равен нулю), соответственно в остаточную сеть необходимо вынести обратную дугу с весом равным пропускной способности. 

```mermaid
graph RL
    c-.->|9|s
    b-.->|5|s
    a-.->|1|b
    c-.->|4|a
    t-.->|12|d
    c-.->|3|b
    t-.->|2|c
    d-.->|7|b
    d-.->|8|c
```

### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> c -> s. Минимальный вес дуг на этом пути равен 2.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    c-.->|7|s
    s-->|2|c
    b-.->|5|s
    a-.->|1|b
    c-.->|4|a
    t-.->|12|d
    c-.->|3|b
    c-->|2|t
    d-.->|7|b
    d-.->|8|c
    style c fill:#2E8B57
    style t fill:#2E8B57
    style s fill:#2E8B57
```

Скорректируем соответствующим образом локальные потоки в исходной сети. Первым числом будем указывать локальный поток, вторым пропускную способность дуги. 

    
```mermaid
graph LR
    s-->|"(2, 9)"|c
    s-->|"(0, 5)"|b
    a-->|"(0, 4)"|c
    b-->|"(0, 1)"|a
    b-->|"(0, 3)"|c
    b-->|"(0, 7)"|d
    c-->|"(0, 8)"|d
    d-->|"(0, 12)"|t
    c-->|"(2, 2)"|t
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети

```mermaid
graph RL
    c-.->|7|s
    s-->|2|c
    b-.->|5|s
    a-.->|1|b
    c-.->|4|a
    t-.->|12|d
    c-.->|3|b
    c-->|2|t
    d-.->|7|b
    d-.->|8|c
```

В остаточной сети найден увеличивающий путь t -> d -> b -> s. Минимальный вес дуг на этом пути равен 5.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    c-.->|7|s
    s-->|2|c
    s-->|5|b
    b-->|5|d
    d-->|5|t
    a-.->|1|b
    c-.->|4|a
    t-.->|7|d
    c-.->|3|b
    c-->|2|t
    d-.->|2|b
    d-.->|8|c
    style t fill:#2E8B57
    style d fill:#2E8B57
    style b fill:#2E8B57
    style s fill:#2E8B57
```

Скорректируем соответствующим образом локальные потоки в исходной сети.

```mermaid
graph LR
    s-->|"(2, 9)"|c
    s-->|"(5, 5)"|b
    a-->|"(0, 4)"|c
    b-->|"(0, 1)"|a
    b-->|"(0, 3)"|c
    b-->|"(5, 7)"|d
    c-->|"(0, 8)"|d
    d-->|"(5, 12)"|t
    c-->|"(2, 2)"|t
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети

```mermaid
graph RL
    c-.->|7|s
    s-->|2|c
    s-->|5|b
    b-->|5|d
    d-->|5|t
    a-.->|1|b
    c-.->|4|a
    t-.->|7|d
    c-.->|3|b
    c-->|2|t
    d-.->|2|b
    d-.->|8|c
```

В остаточной сети найден увеличивающий путь t -> d -> c -> s. Минимальный вес дуг на этом пути равен 7.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    s-->|9|c
    s-->|5|b
    c-->|7|d
    b-->|5|d
    d-->|12|t
    a-.->|1|b
    c-.->|4|a
    c-.->|3|b
    c-->|2|t
    d-.->|2|b
    d-.->|1|c
    style t fill:#2E8B57
    style d fill:#2E8B57
    style s fill:#2E8B57
    style c fill:#2E8B57
```

Скорректируем соответствующим образом локальные потоки в исходной сети.

```mermaid
graph LR
    s-->|"(9, 9)"|c
    s-->|"(5, 5)"|b
    a-->|"(0, 4)"|c
    b-->|"(0, 1)"|a
    b-->|"(0, 3)"|c
    b-->|"(5, 7)"|d
    c-->|"(7, 8)"|d
    d-->|"(12, 12)"|t
    c-->|"(2, 2)"|t
```

### 5. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной **14** является максимальным для данной сети.

### 6. Проверим значение максимального потока перебором всех разрезов сети.
Разрез сети - разбиение множества вершин на два подмножества V<sub>1</sub> и V<sub>2</sub>, где во множество V<sub>1</sub> входит источник, а в V<sub>2</sub> входит сток.

Пропускная способность разреза - сумма пропускной способности дуг, начинающихся в вершинах из множества V<sub>1</sub> и оканчивающихся в вершинах из V<sub>2</sub>.

Для сети из _n_ вершин существует 2<sup>n - 2</sup> различных разрезов, так как две вершины из множества (источник и сток) "зафиксированы" в V<sub>1</sub> и V<sub>2</sub>, остальные вершины можно различными способами распределять между множествами V<sub>1</sub> и V<sub>2</sub>.

Для сети из 6 вершин нужно найти 2<sup>6 - 2</sup> = 2<sup>4</sup> = 16 разрезов. 

| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, d, t    |          **9 + 5 = 14**           |
|   | **s + одна вершина из a, b, c, d** |               |                                |
| 2 | s, a                            | b, c, d, t       |         9 + 5 + 4 = 18        |
| 3 | s, b                            | a, c, d, t       |         9 + 7 + 3 + 1 = 20        |
| 4 | s, c                            | a, b, d, t       |         5 + 8 + 2 = 15         |
| 5 | s, d                            | a, b, с, t       |        9 + 5 + 12 = 26        |
|   | **s + две вершины из a, b, c, d**  |               |                                |
| 6 | s, a, b                         | c, d, t          |         9 + 7 + 3 + 4 = 23         |
| 7 | s, a, c                         | b, d, t          |    5 + 8 + 2 = 15              |
| 8 | s, b, c                         | a, d, t          |  7 + 1 + 8 + 2 = 18             |
| 9 | s, a, d                        | b, c, t          |       9 + 5 + 4 + 12 = 30      |
| 10 | s, b, d                        | a, c, t          |   9 + 1 + 3 + 12 = 25        
| 11 | s, c, d                        | a, b, t          |   5 + 2 + 12 = 19     
|   | **s + три вершины из a, b, c, d**  |               |                                |
| 12 | s, a, b, c                      | d, t             |  7 + 8 + 2 = 17                    |
| 13 | s, d, b, c                      | a, t             |  1 + 2 + 12  = 15                    |
| 14 | s, a, d, c                      | b, t             |  5 + 2 + 12 = 19                    |
| 15 | s, a, b, d                      | c, t             |   9 + 3 + 12 = 24                  |
|   | **s + четыре вершины из a, b, c, d**  |               |                                |
| 16 | s, a, b, c, d                      |t             | **2 + 12 = 14**

Минимальная пропускная способность разреза равна 14 ( {s} / {a, b, c, d, t } ) или ( {s, a, b, c, d} / { t } ), что совпадает с найденной величиной максимального потока в сети.

### Ответ:
Максимальный поток в сети равен 14, он реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|"(9, 9)"|c
    s-->|"(5, 5)"|b
    a-->|"(0, 4)"|c
    b-->|"(0, 1)"|a
    b-->|"(0, 3)"|c
    b-->|"(5, 7)"|d
    c-->|"(7, 8)"|d
    d-->|"(12, 12)"|t
    c-->|"(2, 2)"|t
```