# Задание №9. Команда Second.
### Постановка задачи:
1. Дана сеть (взвешенный ориентированный граф) с источником s и стоком t.
2. Для каждой дуги определена ее пропускная способность.
3. Необходимо найти максимальный поток для указанной сети. 

## Вариант 5:
#### Пропускная способность дуг сети:

|          Дуги          | sa | sс | aс | ba | cb | at | bt | ct |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 8  | 6  | 7  | 4  | 9  | 3  | 9  | 4  |

## Этап 1: Построение сети по таблице (источник s, сток t)

```mermaid
graph LR
    s-->|8|a
    s-->|6|c
    a-->|7|c
    b-->|4|a
    c-->|9|b
    a-->|3|t
    b-->|9|t
    c-->|4|t
```

### Построение остаточной сети
Так как изначально локальный поток в сети не задан, все дуги сети являются пустыми, соответственно в остаточную сеть необходимо вынести обратную дугу с весом равным пропускной способности.

```mermaid
graph LR
    a-.->|8|s
    c-.->|6|s
    c-.->|7|a
    a-.->|4|b
    b-.->|9|c
    t-.->|3|a
    t-.->|9|b
    t-.->|4|c
```

## Этап 2: Поиск увеличивающего пути

В остаточной сети найден увеличивающий путь t -> a -> s. Минимальный вес дуг на этом пути равен 3.

```mermaid
graph RL
    a-.->|8|s
    c-.->|6|s
    c-.->|7|a
    a-.->|4|b
    b-.->|9|c
    t-.->|3|a
    t-.->|9|b
    t-.->|4|c
    style a fill:#008000
    style t fill:#008000
    style s fill:#008000
```

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|**3**|a
    a-.->|**5**|s
    c-.->|6|s
    c-.->|7|a
    a-.->|4|b
    b-.->|9|c
    a-->|**3**|t
    t-.->|9|b
    t-.->|4|c
```

Скорректируем соответствующим образом локальные потоки в исходной сети. Первым числом будем указывать локальный поток, вторым пропускную способность дуги. 

```mermaid
graph LR
    s-->|"**(3,8)**"|a
    s-->|"(0,6)"|c
    a-->|"(0,7)"|c
    b-->|"(0,4)"|a
    c-->|"(0,9)"|b
    a-->|"**(3,3)**"|t
    b-->|"(0,9)"|t
    c-->|"(0,4)"|t
```

## 3. Продолжение поиска увеличивающего пути в остаточной сети

```mermaid
graph LR
    s-->|3|a
    a-.->|5|s
    c-.->|6|s
    c-.->|7|a
    a-.->|4|b
    b-.->|9|c
    a-->|3|t
    t-.->|9|b
    t-.->|4|c
```

В остаточной сети найден увеличивающий путь t -> c -> s. Минимальный вес дуг на этом пути равен 4.

```mermaid
graph LR
    s-->|3|a
    a-.->|5|s
    c-.->|**6**|s
    c-.->|7|a
    a-.->|4|b
    b-.->|9|c
    a-->|3|t
    t-.->|9|b
    t-.->|**4**|c
    style s fill:#008000
    style t fill:#008000
    style c fill:#008000
```

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|3|a
    a-.->|5|s
    s-->|**4**|c
    c-.->|**2**|s
    c-.->|7|a
    a-.->|4|b
    b-.->|9|c
    a-->|3|t
    t-.->|9|b
    c-->|**4**|t
```

Скорректируем соответствующим образом локальные потоки в исходной сети.

```mermaid
graph LR
    s-->|"(3,8)"|a
    s-->|"**(4,6)**"|c
    a-->|"(0,7)"|c
    b-->|"(0,4)"|a
    c-->|"(0,9)"|b
    a-->|"(3,3)"|t
    b-->|"(0,9)"|t
    c-->|"**(4,4)**"|t
```

## 4. Продолжение поиска увеличивающего пути в остаточной сети

```mermaid
graph LR
    s-->|3|a
    a-.->|5|s
    s-->|4|c
    c-.->|2|s
    c-.->|7|a
    a-.->|4|b
    b-.->|9|c
    a-->|3|t
    t-.->|9|b
    c-->|4|t
```

В остаточной сети найден увеличивающий путь t -> b -> c -> s. Минимальный вес дуг на этом пути равен 2.

```mermaid
graph LR
    s-->|3|a
    a-.->|5|s
    s-->|4|c
    c-.->|**2**|s
    c-.->|7|a
    a-.->|4|b
    b-.->|**9**|c
    a-->|3|t
    t-.->|**9**|b
    c-->|4|t
    style t fill:#008000
    style s fill:#008000
    style c fill:#008000
    style b fill:#008000
```

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|3|a
    a-.->|5|s
    s-->|**6**|c
    c-.->|7|a
    a-.->|4|b
    c-->|**2**|b
    b-.->|**7**|c
    a-->|3|t
    b-->|**2**|t
    t-.->|**7**|b
    c-->|4|t
```

Скорректируем соответствующим образом локальные потоки в исходной сети.

```mermaid
graph LR
    s-->|"(3,8)"|a
    s-->|"**(6,6)**"|c
    a-->|"(0,7)"|c
    b-->|"(0,4)"|a
    c-->|"**(2,9)**"|b
    a-->|"(3,3)"|t
    b-->|"**(2,9)**"|t
    c-->|"(4,4)"|t
```

## 5. Продолжение поиска увеличивающего пути в остаточной сети

```mermaid
graph LR
    s-->|3|a
    a-.->|5|s
    s-->|6|c
    c-.->|7|a
    a-.->|4|b
    c-->|2|b
    b-.->|7|c
    a-->|3|t
    b-->|2|t
    t-.->|7|b
    c-->|4|t
```

В остаточной сети найден увеличивающий путь t -> b -> c -> a -> s. Минимальный вес дуг на этом пути равен 5.

```mermaid
graph LR
    s-->|3|a
    a-.->|**5**|s
    s-->|6|c
    c-.->|**7**|a
    a-.->|4|b
    c-->|2|b
    b-.->|**7**|c
    a-->|3|t
    b-->|2|t
    t-.->|**7**|b
    c-->|4|t
    style t fill:#008000
    style s fill:#008000
    style c fill:#008000
    style b fill:#008000
    style a fill:#008000
```

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|**8**|a
    s-->|6|c
    a-->|**5**|c
    c-.->|**2**|a
    a-.->|4|b
    c-->|**7**|b
    b-.->|**2**|c
    a-->|3|t
    b-->|**7**|t
    t-.->|**2**|b
    c-->|4|t
```

Скорректируем соответствующим образом локальные потоки в исходной сети.

```mermaid
graph LR
    s-->|"**(8,8)**"|a
    s-->|"(6,6)"|c
    a-->|"**(5,7)**"|c
    b-->|"(0,4)"|a
    c-->|"**(7,9)**"|b
    a-->|"(3,3)"|t
    b-->|"**(7,9)**"|t
    c-->|"(4,4)"|t
```

## Этап 6. Продолжение поиска увеличивающего пути в остаточной сети
В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной **14** является максимальным для данной сети.

## Этап 7. Проверка значения максимального потока перебором всех разрезов сети.
Разрез сети - разбиение множества вершин на два подмножества V<sub>1</sub> и V<sub>2</sub>, где во множество V<sub>1</sub> входит источник, а в V<sub>2</sub> входит сток.

Пропускная способность разреза - сумма пропускной способности дуг, начинающихся в вершинах из множества V<sub>1</sub> и оканчивающихся в вершинах из V<sub>2</sub>.

Для сети из _n_ вершин существует 2<sup>n - 2</sup> различных разрезов, так как две вершины из множества (источник и сток) "зафиксированы" в V<sub>1</sub> и V<sub>2</sub>, остальные вершины можно различными способами распределять между множествами V<sub>1</sub> и V<sub>2</sub>.

Для сети из 5 вершин нужно найти 2<sup>5 - 2</sup> = 2<sup>3</sup> = 8 разрезов. 

| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, t    |           6 + 8 = **14**       |
|   | **s + одна вершина из a, b, c** |               |                                |
| 2 | s, a                            | b, c, t       |           6 + 7 + 3 = 16       |
| 3 | s, b                            | a, c, t       |           8 + 4 + 9 = 21       |
| 4 | s, c                            | a, b, t       |           8 + 9 + 4 = 21       |
|   | **s + пара вершин из a, b, c**  |               |                                |
| 5 | s, a, b                         | c, t          |           6 + 7 + 9 = 22       |
| 6 | s, a, c                         | b, t          |         9 + 8 + 3 + 4 = 24     |
| 7 | s, b, c                         | a, t          |           8 + 4 + 4 = 16       |
|   | **s + три вершины из a, b, c**  |               |                                |
| 8 | s, a, b, c                      | t             |           3 + 9 + 4 = 16       |

Минимальная пропускная способность разреза равна **14** ( {s} / { a, b, c, t} ), что совпадает с найденной величиной максимального потока в сети.

## Ответ:
Максимальный поток в сети равен **14**, он реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|"(8,8)"|a
    s-->|"(6,6)"|c
    a-->|"(5,7)"|c
    b-->|"(0,4)"|a
    c-->|"(7,9)"|b
    a-->|"(3,3)"|t
    b-->|"(7,9)"|t
    c-->|"(4,4)"|t
```