# Задание №10. Вариант 10
Пропускная способность дуг сети и стоимость транспортировки указана в таблице.

| Дуги                      | sa | sb | sc | ba | bc | cd | ac | ad | dt |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность    | 6  | 6  | 6  | 6  | 5  | 10 | 5  | 8  | 15 |
| Стоимость транспортировки | 2  | 2  | 4  | 1  | 1  | 1  | 3  | 4  | 3  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s-->|6|a
    s-->|6|b
    s-->|6|c
    b-->|6|a
    b-->|5|c
    c-->|10|d
    a-->|5|c
    a-->|8|d
    d-->|15|t
```
Укажем начальный поток величиной 6 **s -> a -> d -> t**. Построим соответствующую остаточную сеть.

```mermaid
graph RL
    s-->|6|a
    b-.->|6|s
    c-.->|6|s
    c-.->|5|b
    c-.->|5|a
    a-.->|6|b
    a-->|6|d
    d-.->|2|a
    d-->|6|t
    t-.->|9|d
    d-.->|10|c
    style t fill:#2E8B57
    style d fill:#2E8B57
    style a fill:#2E8B57
    style s fill:#2E8B57
```

### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> d -> c -> s. Минимальный вес дуг на этом пути равен 6.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    s-->|6|a
    s-->|6|c
    b-.->|6|s
    c-.->|5|b
    c-.->|5|a
    a-.->|6|b
    a-->|6|d
    d-.->|2|a
    d-->|12|t
    t-.->|3|d
    d-.->|4|c
    c-->|6|d
    style t fill:#2E8B57
    style d fill:#2E8B57
    style c fill:#2E8B57
    style s fill:#2E8B57
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> d -> c -> b -> s. Минимальный вес дуг на этом пути равен 3.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|6|a
    s-->|6|c
    b-.->|3|s
    s-->|3|b
    c-.->|2|b
    b-->|3|c
    c-.->|5|a
    a-.->|6|b
    a-->|6|d
    d-.->|2|a
    d-->|15|t
    d-.->|1|c
    c-->|9|d
    style t fill:#2E8B57
    style d fill:#2E8B57
    style c fill:#2E8B57
    style b fill:#2E8B57
    style s fill:#2E8B57
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 15 является максимальным для данной сети.

```mermaid
graph LR
    s-->|6, 6|a
    s-->|3, 6|b
    s-->|6, 6|c
    b-->|0, 6|a
    b-->|3, 5|c
    c-->|9, 10|d
    a-->|0, 5|c
    a-->|6, 8|d
    d-->|15,15|t
```

### 5. Рассчитаем стоимость полученного максимального потока.


| Дуги                            | sa | sb | sc | ba | bc | cd | ac | ad | dt | Итого  |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)    | 6  | 6  | 6  | 6  | 5  | 10 | 5  | 8  | 15 |        |
| Локальный поток f(e)           | 6  | 3  | 6  | 0  | 3  | 9  | 0  | 6  | 15  |        |
| Стоимость транспортировки c(e) | 2  | 2  | 4  | 1  | 1  | 1  | 3  | 4  | 3  |        |
| Суммарная стоимость f(e)*c(e)| 12 | 6 | 24  | 0  | 3 | 9  | 0 | 24  | 45  | **123** |

Стоимость полученного потока составляет 123. 

### 6. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    s-->|-4|c
    b-.->|2|s
    s-->|-2|b
    c-.->|1|b
    b-->|-1|c
    c-.->|3|a
    a-.->|1|b
    a-->|-4|d
    d-.->|4|a
    d-->|-3|t
    d-.->|1|c
    c-->|-1|d
```

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> a -> d -> c -> b -> s (- 2 - 4 + 1 + 1 + 2= -2). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

```mermaid
graph LR
    s-->|6|a
    s-->|6|c
    b-.->|3|s
    s-->|3|b
    c-.->|2|b
    b-->|3|c
    c-.->|5|a
    a-.->|6|b
    a-->|6|d
    d-.->|2|a
    d-->|15|t
    d-.->|1|c
    c-->|9|d
```

Минимальный вес ребра в цикле 1 - это неиспользованный резерв ребра c -> d.

Удалим найденный цикл - уменьшим на 1 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|5|a
    a-.->|1|s
    s-->|6|c
    b-.->|2|s
    s-->|4|b
    c-.->|1|b
    b-->|4|c
    c-.->|5|a
    a-.->|6|b
    a-->|5|d
    d-.->|3|a
    d-->|15|t
    c-->|10|d
```

### 7. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    a-.->|2|s
    s-->|-4|c
    b-.->|2|s
    s-->|-2|b
    c-.->|1|b
    b-->|-1|c
    c-.->|3|a
    a-.->|1|b
    a-->|-4|d
    d-.->|4|a
    d-->|-3|t
    c-->|-1|d
```

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> b -> s (- 4 + 1 + 2= -1). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

```mermaid
graph LR
    s-->|5|a
    a-.->|1|s
    s-->|6|c
    b-.->|2|s
    s-->|4|b
    c-.->|1|b
    b-->|4|c
    c-.->|5|a
    a-.->|6|b
    a-->|5|d
    d-.->|3|a
    d-->|15|t
    c-->|10|d
```

Минимальный вес ребра в цикле 1 - это неиспользованный резерв ребер b -> c.

Удалим найденный цикл - уменьшим на 1 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|5|a
    a-.->|1|s
    s-->|5|c
    c-.->|1|s
    b-.->|1|s
    s-->|5|b
    b-->|5|c
    c-.->|5|a
    a-.->|6|b
    a-->|5|d
    d-.->|3|a
    d-->|15|t
    c-->|10|d
```

### 8. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    a-.->|2|s
    s-->|-4|c
    c-.->|4|s
    b-.->|2|s
    s-->|-2|b
    b-->|-1|c
    c-.->|3|a
    a-.->|1|b
    a-->|-4|d
    d-.->|4|a
    d-->|-3|t
    c-->|-1|d
```
В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 9. Рассчитаем стоимость полученного максимального потока.

| Дуги                            | sa | sb | sc | ba | bc | cd | ac | ad | dt | Итого  |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)    | 6  | 6  | 6  | 6  | 5  | 10 | 5  | 8  | 15 |        |
| Локальный поток f(e)           | 5  | 4  | 6  | 0  | 4  | 10  | 0  | 5  | 15  |        |
| Стоимость транспортировки c(e) | 2  | 2  | 4  | 1  | 1  | 1  | 3  | 4  | 3  |        |
| Суммарная стоимость f(e)*c(e)| 10 | 8 | 24  | 0  | 4 | 10  | 0 | 20  | 45  | **121** |

Стоимость полученного потока составляет 121. 

### Ответ:
Максимальный поток в сети равен 15, минимальная стоимость потока 121, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|5, 6|a
    s-->|4, 6|b
    s-->|6, 6|c
    b-->|0, 6|a
    b-->|4, 5|c
    c-->|10, 10|d
    a-->|0, 5|c
    a-->|5, 8|d
    d-->|15,15|t
```